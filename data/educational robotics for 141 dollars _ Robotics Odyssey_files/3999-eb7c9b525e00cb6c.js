!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b76cda20-d5e0-4bc3-92b6-cb63a86d9265",e._sentryDebugIdIdentifier="sentry-dbid-b76cda20-d5e0-4bc3-92b6-cb63a86d9265")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3999],{64063:function(e){e.exports=function e(n,i){if(n===i)return!0;if(n&&i&&"object"==typeof n&&"object"==typeof i){if(n.constructor!==i.constructor)return!1;if(Array.isArray(n)){if((t=n.length)!=i.length)return!1;for(o=t;0!=o--;)if(!e(n[o],i[o]))return!1;return!0}if(n.constructor===RegExp)return n.source===i.source&&n.flags===i.flags;if(n.valueOf!==Object.prototype.valueOf)return n.valueOf()===i.valueOf();if(n.toString!==Object.prototype.toString)return n.toString()===i.toString();if((t=(d=Object.keys(n)).length)!==Object.keys(i).length)return!1;for(o=t;0!=o--;)if(!Object.prototype.hasOwnProperty.call(i,d[o]))return!1;for(o=t;0!=o--;){var t,o,d,l=d[o];if(!e(n[l],i[l]))return!1}return!0}return n!=n&&i!=i}},63999:function(e,n,i){function t(e){return new o(e)}i.d(n,{Z:function(){return W}});class o extends Error{}function d({id:e,value:n="",pinned:i=!1,mode:o="js",data:d=null,name:a=null,combinePrevious:_,display:r}={}){if((e=+e)!=(0|e)||e<0)throw t("invalid node id");return null!==n&&(n+=""),null!==a&&(a+=""),new l(e,n,!!i,o+"",d,a,_,r)}function l(e,n,i,t,o,d,l,a){Object.defineProperties(this,{id:{value:e,enumerable:!0},value:{value:n,enumerable:!0},pinned:{value:i,enumerable:!0},mode:{value:t,enumerable:!0},data:{value:o,enumerable:!0},name:{value:d,enumerable:!0}}),l&&Object.defineProperties(this,{combinePrevious:{value:l,enumerable:!0}}),a&&Object.defineProperties(this,{display:{value:a,enumerable:!0}})}Object.defineProperties(l,{of:{value:d,writable:!0,configurable:!0}});var a=i(64063);function _(e){let n=new Set;return Array.from(e,e=>{let[i,o]=function({specifier:e,type:n,value:i}){if(null==e)throw t("invalid specifier");if(null==n)throw t("invalid specifier type");if(null==i)throw t("invalid resolution");return s(n+"",e+"",i+"")}(e);if(n.has(i))throw t("duplicate resolution");return n.add(i),o})}function r({specifier:e,specifier_type:n,new_resolution:i}){if(null==e)throw t("invalid specifier");if(null==n)throw t("invalid specifier type");return s(n+"",e+"",null==i?null:i+"")}function s(e,n,i){return[u({type:e,specifier:n}),{type:e,specifier:n,value:i}]}function u({type:e,specifier:n}){return`${e}:${n}`}let w=new WeakMap;function p(e){let n=w.get(e);return void 0===n&&(n=new Map(e.map(e=>[u(e),e.value])),w.set(e,n)),n}let c="create",v="insert_node",f="modify_node",h="modify_title",y="move_node",m="remove_node",b="pin_node",g="unpin_node",x="resolve_dependency",k="revert",P="modify_license",M="modify_copyright",I="mode_node",O="modify_data",j="modify_name",A="noop";function S(){}function E(e,n,i,t){if(null==i)return n;let o=n.findIndex(e=>e.id===i),d=n[o];return d.combinePrevious===t||(n===e.nodes&&(n=n.slice()),n[o]=new l(d.id,d.value,d.pinned,d.mode,d.data,d.name,t,d.display)),n}function D(e){let n=new Map;for(let[i,t]of e)n.set(t,i);return n}function $(e,n){return Array.from({length:Math.min(e.version,n.version)+1},(e,n)=>[n,n])}function N(e){Object.defineProperties(this,{_node:{value:e,writable:!0}})}function C({version:e=0,title:n="",license:i=null,copyright:o="",nodes:l=[],resolutions:a=[]}={}){if((e=+e)!=(0|e)||e<0)throw t("invalid version");null!==i&&(i+=""),l=Array.from(l,d),a=_(a);let r=Array(e+1);for(let n=0;n<l.length;++n){let{id:i}=l[n];if(i>e)throw t("invalid node_id");if(i in r)throw t("duplicate node_id");r[i]=n}return new W({version:e,title:n+"",license:i,copyright:o+"",nodes:l,events:Array(e+1),resolutions:a})}function R(e){if(void 0===e)throw t("insufficient history");let{version:n,type:i,node_id:o,new_node_value:d,new_node_pinned:l,new_next_node_id:a,new_node_mode:_,new_node_data:r,new_node_name:s,specifier:u,specifier_type:w,new_resolution:p,new_combine:S,new_node_display:E}=e;switch(i){case h:return{version:n,type:i,new_node_value:d};case v:return{version:n,type:i,node_id:o,new_node_value:d,new_next_node_id:a,new_node_pinned:l,new_node_mode:_,new_node_data:r,new_node_name:s,new_combine:S,new_node_display:E};case m:return{version:n,type:i,node_id:o};case y:return{version:n,type:i,node_id:o,new_next_node_id:a,new_combine:S,new_node_display:E};case f:return{version:n,type:i,node_id:o,new_node_value:d};case b:case g:return{version:n,type:i,node_id:o};case P:case M:return{version:n,type:i,new_node_value:d};case I:return{version:n,type:i,node_id:o,new_node_mode:_,new_node_value:d,new_node_pinned:l,new_node_data:r,new_node_name:s};case O:return{version:n,type:i,node_id:o,new_node_data:r};case j:return{version:n,type:i,node_id:o,new_node_name:s};case x:return{version:n,type:i,specifier:u,specifier_type:w,new_resolution:p};case A:return{version:n,type:i};case c:throw t("cannot redo create");case k:throw t("cannot redo revert");default:throw t("unknown type")}}function W({version:e,title:n,license:i,copyright:t,nodes:o,events:d,resolutions:l}){Object.defineProperties(this,{version:{value:e,enumerable:!0},title:{value:n,enumerable:!0},license:{value:i,enumerable:!0},copyright:{value:t,enumerable:!0},nodes:{value:o,enumerable:!0},events:{value:d,enumerable:!0},resolutions:{value:l,enumerable:!0}})}Object.defineProperties(N.prototype,{[Symbol.iterator]:{value:function(){return this},writable:!0,configurable:!0},next:{value:function(){if(null==this._node)return{done:!0};let e=this._node;return this._node=this._node.next,{done:!1,value:e}},writable:!0,configurable:!0}}),Object.defineProperties(W,{create:{value:function({version:e,title:n="",nodes:i=[],license:o=null,copyright:l="",resolutions:a=[]}={}){i=Array.from(i,d),a=_(a);let r=new Set,s=[];if(void 0!==e&&((e=+e)!=(0|e)||e<0))throw t("invalid version");let u=-1,w=-1;(n+="")&&(s[++u]={version:u,type:h,new_node_value:n}),null!==o&&(s[++u]={version:u,type:P,new_node_value:o+=""}),(l+="")&&(s[++u]={version:u,type:M,new_node_value:l});for(let e=0;e<i.length;e++){let{id:n,value:o,pinned:d,mode:l,data:a,name:_,combinePrevious:p,display:c}=i[e];if(p&&0===e)throw t("the first node cannot combine previous");if(r.has(n))throw t("duplicate node_id");r.add(n),s[++u]={version:u,type:v,node_id:n,new_next_node_id:null,new_node_value:o,new_node_pinned:d,new_node_mode:l,new_node_data:a,new_node_name:_,...p?{new_combine:"previous"}:null,...c?{new_node_display:c}:null},n>w&&(w=n)}for(let{type:e,specifier:n,value:i}of a)s[++u]={version:u,type:x,specifier:n,specifier_type:e,new_resolution:i};if(void 0===e)e=Math.max(u,w)+1;else if(u>=e||e<w)throw t("invalid version");return s[e]={version:e,type:c},new W({version:e,title:n,nodes:i,events:s,license:o,copyright:l,resolutions:a})},writable:!0,configurable:!0},from:{value:function(e){let n="",i=-1,o=null,d="",l=-1,_=!1,s=new Map,u=new Map,w=null,p=null;function k(e,n,i){let o=n?n.previous:w;switch(n?(e.next=n,n.previous=e):w=e,o?(e.previous=o,o.next=e):p=e,i){case"previous":e.combinePrevious=!0;break;case"next":if(e.next){if(e.next.combinePrevious)throw t("can only combine next at the beginning of a row");e.next.combinePrevious=!0}}}function S(e){let n=e.next,i=e.previous;!e.combinePrevious&&n&&n.combinePrevious&&(n.combinePrevious=!1),e.combinePrevious=!1,n?(n.previous=i,e.next=null):w=i,i?(i.next=n,e.previous=null):p=n}for(let w of e){let e=+w.version;if(e!==(0|e)||!(e>=i))throw t("invalid version");switch(i=e,w.type){case c:if(_)throw t("duplicate create");if(l>i)throw t("invalid node_id");_=!0;break;case h:n=w.new_node_value;break;case v:{let e=i;if(void 0!==w.node_id){if((e=+w.node_id)!=(0|e)||e<0||_&&e>i)throw t("invalid node_id");if(s.has(e))throw t("duplicate node_id")}let n=null;if(null!=w.new_next_node_id&&void 0===(n=s.get(+w.new_next_node_id)))throw t("invalid new_next_node_id");l=Math.max(e,l);let o={id:e,value:w.new_node_value,pinned:w.new_node_pinned,mode:w.new_node_mode,data:w.new_node_data,name:w.new_node_name,display:w.new_node_display,next:null,previous:null};k(o,n,w.new_combine),s.set(e,o);break}case f:{let e=s.get(+w.node_id);if(void 0===e)throw t("invalid node_id");e.value=w.new_node_value;break}case y:{let e=s.get(+w.node_id);if(void 0===e)throw t("invalid node_id");let n=null;if(null!=w.new_next_node_id&&void 0===(n=s.get(+w.new_next_node_id)))throw t("invalid new_next_node_id");let i=e.next?e.combinePrevious?"previous":!e.combinePrevious&&e.next.combinePrevious?"next":void 0:e.combinePrevious?"previous":void 0,o=e.display;i===w.new_combine&&a(o,w.new_node_display)&&(e.next===n||e===n)||(S(e),k(e,n,w.new_combine),e.display=w.new_node_display,w.new_node_display||delete e.display);break}case m:{let e=+w.node_id,n=s.get(e);if(void 0===n)throw t("invalid node_id");S(n),s.delete(e);break}case b:case g:{let e=s.get(+w.node_id);if(void 0===e)throw t("invalid node_id");e.pinned=w.type===b;break}case I:{let e=s.get(+w.node_id);if(void 0===e)throw t("invalid node_id");e.mode=w.new_node_mode,void 0!==w.new_node_value&&(e.value=w.new_node_value),void 0!==w.new_node_pinned&&(e.pinned=w.new_node_pinned),void 0!==w.new_node_data&&(e.data=w.new_node_data),void 0!==w.new_node_name&&(e.name=w.new_node_name);break}case j:{let e=s.get(+w.node_id);if(void 0===e)throw t("invalid node_id");e.name=w.new_node_name;break}case O:{let e=s.get(+w.node_id);if(void 0===e)throw t("invalid node_id");e.data=w.new_node_data;break}case P:o=w.new_node_value;break;case M:d=w.new_node_value;break;case x:{let[e,n]=r(w);if(null!==n.value)u.set(e,n);else if(u.has(e))u.delete(e);else throw t("invalid resolution");break}case A:break;default:throw t("unknown type")}}if(!_)throw t("expected create");return C({version:i,title:n,license:o,copyright:d,nodes:new N(p),resolutions:u.values()})},writable:!0,configurable:!0},of:{value:C,writable:!0,configurable:!0},Node:{value:l,writable:!0,configurable:!0},Error:{value:o,writable:!0,configurable:!0}}),Object.defineProperties(W.prototype,{apply:{value:function(e,n=S){let i=this.version,o=this.title,d=this.license,_=this.copyright,s=this.nodes,w=this.events,p=this.resolutions;for(let S of e){let e=i;switch(i=w.length,w===this.events&&(w=w.slice()),S.type){case h:{let t=void 0===S.new_node_value?"":S.new_node_value+"";if(o===t)break;n(w[w.length]={version:i,old_version:e,type:h,old_node_value:o,new_node_value:t}),o=t;continue}case v:{let o=i;if(void 0!==S.node_id){if((o=+S.node_id)!=(0|o)||o<0||o>i)throw t("invalid node_id");if(s.findIndex(e=>e.id===o)>=0)throw t("duplicate node_id")}let d=s.length,a=null;if(null!=S.new_next_node_id&&(a=+S.new_next_node_id,(d=s.findIndex(e=>e.id===a))<0))throw t("invalid new_next_node_id");let _=void 0===S.new_node_value?"":null===S.new_node_value?null:S.new_node_value+"",r=!!S.new_node_pinned,u=void 0===S.new_node_mode?"js":S.new_node_mode+"",p=null==S.new_node_data?null:S.new_node_data,c=null==S.new_node_name?null:S.new_node_name+"",f=null==S.new_combine?null:S.new_combine,h=null==S.new_node_display?null:S.new_node_display;s===this.nodes&&(s=s.slice());let y=new l(o,_,r,u,p,c,"previous"===f,h);s.splice(d,0,y),"next"===f&&E(this,s,a,!0),n(w[w.length]={version:i,old_version:e,type:v,node_id:o,new_next_node_id:a,new_node_value:y.value,new_node_pinned:y.pinned,new_node_mode:y.mode,new_node_data:y.data,new_node_name:y.name,...f?{new_combine:f}:null,...h?{new_node_display:h}:null});continue}case f:{let o=+S.node_id,d=s.findIndex(e=>e.id===o);if(d<0)throw t("invalid node_id");let a=s[d].value,_=void 0===S.new_node_value?"":null===S.new_node_value?null:S.new_node_value+"";if(a===_)break;s===this.nodes&&(s=s.slice()),s[d]=new l(o,_,s[d].pinned,s[d].mode,s[d].data,s[d].name,s[d].combinePrevious,s[d].display),n(w[w.length]={version:i,old_version:e,type:f,node_id:o,old_node_value:a,new_node_value:_});continue}case y:{let o=+S.node_id,d=s.findIndex(e=>e.id===o);if(d<0)throw t("invalid node_id");let _=function(e,n){let i=e[n];if(n===e.length-1)return i.combinePrevious?"previous":void 0;let t=e[n+1];return i.combinePrevious?"previous":!i.combinePrevious&&t.combinePrevious?"next":void 0}(s,d),r=s[d].display,u=s[d],p=s.length,c=null;if(null!=S.new_next_node_id&&(c=+S.new_next_node_id,(p=s.findIndex(e=>e.id===c))<0))throw t("invalid new_next_node_id");let v=d<s.length-1?s[d+1].id:null;d===p&&(c=v),v!==c&&(s===this.nodes&&(s=s.slice()),s.splice(d,1),s.splice(p-(d<p),0,u));let f=S.new_combine,h=S.new_node_display;if(v===c&&f===_&&a(h,r))break;if(s=function(e,n,i,t,o){if(null==i)return n;let d=n.findIndex(e=>e.id===i),_=n[d],r=0===d?null:n[d-1],s=n.find(e=>e.id===t);return s&&!s.display?.presentation?.hidden&&o?.presentation?.hidden?o={...o,presentation:{hidden:!1}}:r&&r.display?.presentation?.hidden&&(o={...o,presentation:{hidden:!0}}),a(o,_.display)||(n===e.nodes&&(n=n.slice()),n[d]=new l(_.id,_.value,_.pinned,_.mode,_.data,_.name,_.combinePrevious,o)),n}(this,s,o,c,h),"previous"===f){if(0===d&&p<=1||0===p)throw t("the first node cannot combine previous");s=E(this,s,o,!0),"next"===_&&(s=E(this,s,c,!1),null!=v&&v!==c&&(s=E(this,s,c,!0),s=E(this,s,v,!1)))}else if("next"===f){if(null===c)throw t("cannot combine right the last node");s=E(this,s,c,!0),"previous"===_&&(s=E(this,s,o,!1)),"next"===_&&(s=E(this,s,v,!1))}else null==f&&(s=E(this,s,o,!1),s=E(this,s,c,!1),"next"===_&&(s=E(this,s,v,!1)));n(w[w.length]={version:i,old_version:e,type:y,node_id:o,old_next_node_id:v,new_next_node_id:c,..._||f?{old_combine:_,new_combine:f}:null,...r||h?{old_node_display:r,new_node_display:h}:null});continue}case m:{let o=+S.node_id,d=s.findIndex(e=>e.id===o);if(d<0)throw t("invalid node_id");let l=d<s.length-1?s[d+1].id:null,a=s[d];s===this.nodes&&(s=s.slice()),s.splice(d,1),n(w[w.length]={version:i,old_version:e,type:m,node_id:o,old_next_node_id:l,old_node_value:a.value,old_node_pinned:a.pinned,old_node_mode:a.mode,old_node_data:a.data,old_node_name:a.name});continue}case b:case g:{let o=+S.node_id,d=s.findIndex(e=>e.id===o);if(d<0)throw t("invalid node_id");let a=S.type===b;if(s[d].pinned===a)break;s===this.nodes&&(s=s.slice()),s[d]=new l(o,s[d].value,a,s[d].mode,s[d].data,s[d].name,s[d].combinePrevious,s[d].display),n(w[w.length]={version:i,old_version:e,type:S.type,node_id:o});continue}case I:{let o=+S.node_id,d=s.findIndex(e=>e.id===o);if(d<0)throw t("invalid node_id");let a=s[d].mode,_=S.new_node_mode+"";if(a===_)break;let r=s[d].value,u=void 0===S.new_node_value?r:null===S.new_node_value?S.new_node_value:S.new_node_value+"",p=s[d].pinned,c=void 0===S.new_node_pinned?p:!!S.new_node_pinned,v=s[d].name,f=void 0===S.new_node_name?v:null===S.new_node_name?S.new_node_name:S.new_node_name+"",h=s[d].data,y=void 0===S.new_node_data?h:S.new_node_data;s===this.nodes&&(s=s.slice()),s[d]=new l(o,u,c,_,y,f,s[d].combinePrevious,s[d].display),n(w[w.length]={version:i,old_version:e,type:S.type,node_id:o,new_node_mode:_,old_node_mode:a,new_node_value:u,old_node_value:r,new_node_pinned:c,old_node_pinned:p,new_node_data:y,old_node_data:h,new_node_name:f,old_node_name:v});continue}case k:{i=+S.node_id;let t=new W({version:e,title:o,nodes:s,events:w,license:d,copyright:_,resolutions:p});({version:i,title:o,nodes:s,license:d,copyright:_,resolutions:p}=t.reset(i,n)),w[w.length]={version:w.length,old_version:e,type:k,node_id:i};continue}case P:{let t=null==S.new_node_value?null:S.new_node_value+"";if(d===t)break;n(w[w.length]={version:i,old_version:e,type:P,old_node_value:d,new_node_value:t}),d=t;continue}case M:{let t=void 0===S.new_node_value?"":S.new_node_value+"";if(_===t)break;n(w[w.length]={version:i,old_version:e,type:M,old_node_value:_,new_node_value:t}),_=t;continue}case x:{let[t,{specifier:o,type:d,value:l}]=r(S),a=p.findIndex(e=>u(e)===t);if(a>=0&&p[a].value===l||a<0&&null===l)break;p===this.resolutions&&(p=p.slice());let _=a<0?null:p[a].value;null===l?p.splice(a,1):a<0?p.push({specifier:o,type:d,value:l}):p[a]={...p[a],value:l},n(w[w.length]={version:i,old_version:e,type:x,specifier:o,specifier_type:d,old_resolution:_,new_resolution:l});continue}case O:{let o=+S.node_id,d=s.findIndex(e=>e.id===o);if(d<0)throw t("invalid node_id");let _=s[d].data,r=null==S.new_node_data?null:S.new_node_data;if(a(r,_))break;s===this.nodes&&(s=s.slice()),s[d]=new l(o,s[d].value,s[d].pinned,s[d].mode,r,s[d].name,s[d].combinePrevious,s[d].display),n(w[w.length]={version:i,old_version:e,node_id:o,type:S.type,old_node_data:_,new_node_data:r});continue}case j:{let o=+S.node_id,d=s.findIndex(e=>e.id===o);if(d<0)throw t("invalid node_id");let a=s[d].name,_=null==S.new_node_name?null:S.new_node_name+"";if(a===_)break;s===this.nodes&&(s=s.slice()),s[d]=new l(o,s[d].value,s[d].pinned,s[d].mode,s[d].data,_,s[d].combinePrevious,s[d].display),n(w[w.length]={version:i,old_version:e,type:S.type,node_id:o,new_node_name:_,old_node_name:a});continue}case A:break;case c:throw t("cannot apply create");default:throw t("unknown type")}n(w[w.length]={version:i,old_version:e,type:A})}return w===this.events?this:new W({version:i,title:o,nodes:s,events:w,license:d,copyright:_,resolutions:p})},writable:!0,configurable:!0},diff:{value:function(e,n=$(e,this)){let i=new Map(this.nodes.map(e=>[e.id,e])),t=new Map(e.nodes.map(e=>[e.id,e])),o=new Map(n),d=D(n),l=e.nodes.map(e=>{let n=d.get(e.id),t=i.get(n);return t?{type:t.value===e.value?A:f,base:t,target:e}:{type:null==n?v:m,target:e}});e:for(let e=0,n=this.nodes.length;e<n;++e){let i=this.nodes[e],d=o.get(i.id);if(t.has(d))continue;let a={type:null==d?v:m,base:i};for(let i=e+1;i<n;++i){let e=t.get(o.get(this.nodes[i].id));if(e){l.splice(l.findIndex(n=>n.target===e),0,a);continue e}}l.push(a)}return l},writable:!0,configurable:!0},merge:{value:function(e,n){var i;let o,d;if(Array.isArray(e)||(e=Array.from(e)),n&&(i=n,n=function(e){i(R(e))}),0===e.length)return[this,new Map];let l=+e[0].version,_=e.length,r=this.version-l+1,s=Math.min(_,r),u=this.reset(l-1,n).apply(e,n);for(o=0,e=u.events.slice(l);o<s;++o){let n=e[o],i=this.events[n.version];if(n.type===v&&n.node_id===n.version||n.type!==i.type||n.specifier!==i.specifier||n.specifier_type!==i.specifier_type||n.new_resolution!==i.new_resolution||n.node_id!==i.node_id||n.new_node_value!==i.new_node_value||n.new_node_pinned!==i.new_node_pinned||n.new_next_node_id!==i.new_next_node_id||n.new_node_mode!==i.new_node_mode||n.new_node_name!==i.new_node_name||n.new_combine!==i.new_combine||!a(n.new_node_display,i.new_node_display)||!a(n.new_node_data,i.new_node_data))break}if(o===_)return[this,new Map];if(o===r)return[u,new Map];let w=new Set,p=new Map;for(d=o;d<_;++d){let n=e[d];switch(n.type){case v:n.node_id<l&&w.add(n.node_id),p.delete(n.node_id);break;case m:w.delete(n.node_id),p.set(n.node_id,n.old_next_node_id)}}let c=new Map,k=[];for(d=l+o;d<=this.version;++d){let e=this.events[d];switch(e.type){case h:k.push({type:h,new_node_value:e.new_node_value});break;case v:{let n=e.node_id;c.has(n)?n=c.get(n):(n>=l||w.has(n))&&c.set(n,n=u.version+k.length+1);let i=e.new_next_node_id;if(c.has(i))i=c.get(i);else for(;p.has(i);)i=p.get(i);p.delete(n),k.push({type:v,node_id:n,new_node_value:e.new_node_value,new_node_pinned:e.new_node_pinned,new_next_node_id:i,new_node_mode:e.new_node_mode,new_node_data:e.new_node_data,new_node_name:e.new_node_name,...e.new_combine?{new_combine:e.new_combine}:null,...e.new_node_display?{new_node_display:e.new_node_display}:null});break}case f:{let n=e.node_id;if(c.has(n))n=c.get(n);else if(p.has(n))break;k.push({type:f,node_id:n,new_node_value:e.new_node_value});break}case y:{let n=e.node_id;if(c.has(n))n=c.get(n);else if(p.has(n))break;let i=e.new_next_node_id;if(c.has(i))i=c.get(i);else for(;p.has(i);)i=p.get(i);k.push({type:y,node_id:n,new_next_node_id:i,...e.new_combine?{new_combine:e.new_combine}:null,...e.new_node_display?{new_node_display:e.new_node_display}:null});break}case m:{let n=e.node_id;if(c.has(n))n=c.get(n);else if(p.has(n))break;w.delete(n),k.push({type:m,node_id:n});break}case b:case g:{let n=e.node_id;if(c.has(n))n=c.get(n);else if(p.has(n))break;k.push({type:e.type,node_id:n});break}case I:{let n=e.node_id;if(c.has(n))n=c.get(n);else if(p.has(n))break;k.push({type:e.type,node_id:n,new_node_mode:e.new_node_mode,new_node_pinned:e.new_node_pinned,new_node_value:e.new_node_value,new_node_data:e.new_node_data,new_node_name:e.new_node_name});break}case O:{let n=e.node_id;if(c.has(n))n=c.get(n);else if(p.has(n))break;k.push({type:e.type,node_id:n,new_node_data:e.new_node_data});break}case j:{let n=e.node_id;if(c.has(n))n=c.get(n);else if(p.has(n))break;k.push({type:e.type,node_id:n,new_node_name:e.new_node_name});break}case P:k.push({type:P,new_node_value:e.new_node_value});break;case M:k.push({type:M,new_node_value:e.new_node_value});break;case x:k.push({type:x,specifier:e.specifier,specifier_type:e.specifier_type,new_resolution:e.new_resolution});break;case A:break;default:throw t("unknown type")}}return[u.apply(k,n),c]},writable:!0,configurable:!0},patch:{value:function(e,n=$(e,this)){let i;let t=new Map(this.nodes.map(e=>[e.id,e])),o=new Map(this.nodes.slice(0,-1).map((e,n)=>[e.id,this.nodes[n+1].id])),d=new Map(this.nodes.slice(1).map((e,n)=>[e.id,this.nodes[n].id])),l=new Map(n),_=D(n),r=this.nodes.length?this.nodes[this.nodes.length-1].id:void 0,s=new Set(e.nodes.map(e=>e.id)),w=[],c=new Map,k=this.events.length-1;for(let{id:n}of(this.title!==e.title&&(++k,w.push({type:h,new_node_value:e.title})),this.license!==e.license&&(++k,w.push({type:P,new_node_value:e.license})),this.copyright!==e.copyright&&(++k,w.push({type:M,new_node_value:e.copyright})),this.nodes))if(!s.has(l.get(n))){++k,w.push({type:m,node_id:n});let e=d.get(n),i=o.get(n);void 0!==i?(o.set(n,o.get(i)),d.set(i,e)):r=e,void 0!==e&&(d.set(n,d.get(e)),o.set(e,i))}for(let n=e.nodes.length-1;n>=0;--n){let i=e.nodes[n],s=e.nodes[n+1]&&_.get(e.nodes[n+1].id),{id:u}=i,p=_.get(u),h=t.get(p);if(h){h.mode!==i.mode?(++k,w.push({type:I,node_id:p,new_node_mode:i.mode,new_node_value:i.value,new_node_pinned:i.pinned,new_node_name:i.name,new_node_data:i.data})):(h.value!==i.value&&(++k,w.push({type:f,node_id:p,new_node_value:i.value})),h.pinned!==i.pinned&&(++k,w.push({type:i.pinned?b:g,node_id:p})),h.name!==i.name&&(++k,w.push({type:j,node_id:p,new_node_name:i.name})),a(h.data,i.data)||(++k,w.push({type:O,node_id:p,new_node_data:i.data})));let e=o.get(p);if(e!==s){++k,w.push({type:y,node_id:p,new_next_node_id:void 0===s?null:s});let n=d.get(p),i=void 0!==s?d.get(s):r;void 0!==n&&o.set(n,e),void 0!==e&&d.set(e,n),o.set(p,s),d.set(p,i),void 0!==i&&o.set(i,p),void 0!==s?d.set(s,p):r=p}}else{let e=++k;null==p&&(p=e,_.set(u,p),l.set(p,u),c.set(p,u)),w.push({type:v,node_id:p,new_node_value:i.value,new_node_pinned:i.pinned,new_next_node_id:void 0===s?null:s,new_node_mode:i.mode,new_node_data:i.data,new_node_name:i.name});let n=void 0!=s?d.get(s):r;void 0!=n&&o.set(n,p),void 0!=s?d.set(s,p):r=p,o.set(p,s),d.set(p,n)}}let{nodes:A}=this.apply(w);for(let n=A.length-1;n>=0;--n){let t=A[n],o=A[n+1],d=e.nodes[n];if(a(t.display,d.display)||(++k,w.push({type:y,node_id:t.id,new_next_node_id:o?o.id:null,new_node_display:d.display})),0===n)continue;let l=A[n-1];void 0===i&&(i=!!t.combinePrevious||null),i!=d.combinePrevious?(++k,w.push({type:y,node_id:l.id,new_next_node_id:t.id,new_combine:d.combinePrevious?"next":null}),i=!1):i=l.combinePrevious}let S=p(this.resolutions);for(let n of e.resolutions)S.get(u(n))!==n.value&&w.push({type:x,specifier:n.specifier,specifier_type:n.type,new_resolution:n.value});let E=p(e.resolutions);for(let e of this.resolutions)E.has(u(e))||w.push({type:x,specifier:e.specifier,specifier_type:e.type,new_resolution:null});return[w,c]},writable:!0,configurable:!0},reset:{value:function(e,n){if((e=+e)<0||e>=this.events.length||e!==(0|e))throw t("invalid version");if(e===this.events.length-1)return this;let i=Array.from(function* e(n,i,o){for(;o<i;){let d=n[i--];if("revert"===d.type){let{old_version:i,node_id:t}=d;if(i<=o)return yield*e(n,t,o);yield*e(n,t,i)}else{let e=function(e){if(void 0===e)throw t("insufficient history");let{old_version:n,type:i,node_id:o,old_node_value:d,old_node_pinned:l,old_next_node_id:a,old_node_mode:_,old_node_data:r,old_node_name:s,specifier:u,specifier_type:w,old_resolution:p,old_combine:S,old_node_display:E}=e;switch(i){case h:return{version:n,type:i,new_node_value:d};case v:return{version:n,type:m,node_id:o};case m:return{version:n,type:v,node_id:o,new_node_value:d,new_node_pinned:l,new_next_node_id:a,new_node_mode:_,new_node_data:r,new_node_name:s,new_combine:S,new_node_display:E};case y:return{version:n,type:i,node_id:o,new_next_node_id:a,new_combine:S,new_node_display:E};case f:return{version:n,type:i,node_id:o,new_node_value:d};case b:return{version:n,type:g,node_id:o};case g:return{version:n,type:b,node_id:o};case P:case M:return{version:n,type:i,new_node_value:d};case I:return{version:n,type:i,node_id:o,new_node_mode:_,new_node_value:d,new_node_pinned:l,new_node_data:r,new_node_name:s};case O:return{version:n,type:i,node_id:o,new_node_data:r};case j:return{version:n,type:i,node_id:o,new_node_name:s};case x:return{version:n,type:i,specifier:u,specifier_type:w,new_resolution:p};case A:return{version:n,type:i};case c:throw t("cannot undo create");case k:throw t("cannot undo revert");default:throw t("unknown type")}}(d);if(yield e,e.version===o)return}}for(;i<o;){let t=n[++i];if("revert"===t.type){let{old_version:i,node_id:d}=t;if(d>=o)return yield*e(n,i,o);yield*e(n,i,d)}else{let e=R(t);if(yield e,e.version===o)return}}}(this.events,this.version,e));n&&i.forEach(n);let{title:o,license:d,copyright:l,nodes:a,resolutions:_}=this.apply(i);return i.length&&(e=i[i.length-1].version),new W({version:e,title:o,license:d,copyright:l,nodes:a,events:this.events.slice(0,e+1),resolutions:_})},writable:!0,configurable:!0},resolve:{value:function(e,n){if(null==e)throw t(`invalid specifier type: ${e}`);if(null==n)throw t(`invalid specifier: ${n}`);return p(this.resolutions).get(u({type:e,specifier:n}))},writable:!0,configurable:!0}})}}]);
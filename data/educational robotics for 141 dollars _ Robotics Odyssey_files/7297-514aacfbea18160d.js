!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="d3493a43-0908-401c-8206-7f078327aa66",e._sentryDebugIdIdentifier="sentry-dbid-d3493a43-0908-401c-8206-7f078327aa66")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7297],{92884:function(e,t,n){n.d(t,{Bv:function(){return h},CL:function(){return s},F5:function(){return d},Hf:function(){return R},Hh:function(){return g},JB:function(){return b},JS:function(){return T},M6:function(){return c},Nl:function(){return k},Nz:function(){return M},d$:function(){return l},dE:function(){return a},dX:function(){return V},fe:function(){return y},hO:function(){return f},hX:function(){return w},kg:function(){return p},lA:function(){return S},mB:function(){return u},pf:function(){return r},tq:function(){return v},yy:function(){return m}});var o=n(46294),i=n(8273);let a=(e,t)=>{let{notebook:n,currentUser:a}=e,{publishLevel:s}=t;"shared"===s?(0,i.cg)(n)?(0,o.MR)((0,o.ym)({type:"notebook:manage:linkReshared",data:{},eventVersion:3,notebook:n,currentUser:a})):(0,o.MR)((0,o.ym)({type:"notebook:manage:linkSharingEnabled",data:{},eventVersion:3,notebook:n,currentUser:a})):(0,i.s9)(n)?((0,o.MR)((0,o.ym)({type:"notebook:manage:republish",data:{},eventVersion:1,notebook:n,currentUser:a})),gtag("event","Republish",{event_category:"Notebook"})):((0,o.MR)((0,o.ym)({type:"notebook:manage:publish",data:{},eventVersion:5,notebook:n,currentUser:a})),gtag("event","Publish",{event_category:"Notebook"}))},s=e=>{let{notebook:t,currentUser:n}=e;(0,i.s9)(t)?(0,o.MR)((0,o.ym)({type:"notebook:manage:unpublish",data:{},eventVersion:6,notebook:t,currentUser:n})):(0,o.MR)((0,o.ym)({type:"notebook:manage:linkSharingDisabled",data:{},eventVersion:3,notebook:t,currentUser:n}))},l=(e,t)=>{let{notebook:n,currentUser:i}=e,{trashed:a}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:trash",data:{trashed:a},eventVersion:6,notebook:n,currentUser:i}))},r=(e,t)=>{let{notebook:n,currentUser:i}=e,{slug:a}=t;a?(0,o.MR)((0,o.ym)({type:"notebook:manage:slugSet",data:{},eventVersion:2,notebook:n,currentUser:i})):(0,o.MR)((0,o.ym)({type:"notebook:manage:slugsCleared",data:{},eventVersion:2,notebook:n,currentUser:i}))},u=(e,t)=>{let{notebook:n,currentUser:i}=e,{license:a}=t;n.model.license!==a&&(0,o.MR)((0,o.ym)({type:"notebook:edit:license",data:{license:a},eventVersion:2,notebook:n,currentUser:i}))},d=(e,t)=>{let{notebook:n,currentUser:i}=e,{locked:a}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:commentingLock",data:{locked:a},eventVersion:1,notebook:n,currentUser:i}))},c=(e,t)=>{let{notebook:n,currentUser:i}=e,{source:a}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:embedModalCopy",data:{trigger:"click",has_document_key:!!n.documentKey,source:a},eventVersion:2,notebook:n,currentUser:i}))},p=(e,t)=>{let{notebook:n,currentUser:i}=e,{trigger:a,source:s}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:downloadNotebook",data:{trigger:a,source:s},eventVersion:2,notebook:n,currentUser:i}))},g=(e,t)=>{let{notebook:n,currentUser:i}=e,{base:a,target:s,trigger:l,source:r}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:suggestFailed",data:{from_id:s.id,to_id:a.id,base:(0,o.tb)(a,i),target:(0,o.tb)(s,i),trigger:l,source:r},eventVersion:4,notebook:n,currentUser:i}))},m=(e,t)=>{let{notebook:n,currentUser:i}=e,{base:a,target:s,source:l,trigger:r}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:suggest",data:{from_id:s.id,to_id:a.id,base:(0,o.tb)(a,i),target:(0,o.tb)(s,i),source:l,trigger:r},eventVersion:4,notebook:n,currentUser:i}))},b=(e,t)=>{let{notebook:n,currentUser:i}=e,{source:a,trigger:s}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:suggestionClosed",data:{base:(0,o.tb)(n.forkOf,i),target:(0,o.tb)(n,i),suggestionId:n.suggestionFrom.id,isSuggester:n.suggestionFrom.creator.id===i.id,source:a,trigger:s},eventVersion:1,notebook:n,currentUser:i}))},h=(e,t)=>{let{notebook:n,currentUser:i}=e,{trigger:a,source:s,nodeId:l,nodeMode:r}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:openNotebookFilePicker",data:{trigger:a,source:s,cellIds:l?[l]:[],nodeMode:r},eventVersion:1,notebook:n,currentUser:i}))},y=(e,t)=>{let{notebook:n,currentUser:i}=e,{files:a,trigger:s,source:l,nodeMode:r}=t;a.length&&(0,o.MR)((0,o.ym)({type:"notebook:manage:attachFiles",data:{files:a.map(e=>{let{type:t,size:n}=e;return{mimeType:t,size:n}}),trigger:s,source:l,cellIds:void 0!==t.nodeId?[t.nodeId]:[],nodeMode:r},eventVersion:1,notebook:n,currentUser:i}))},f=(e,t)=>{let{notebook:n,currentUser:i}=e,{name:a}=t,{status:s,size:l,mimeType:r}=n.files.get(a);(0,o.MR)((0,o.ym)({type:"notebook:manage:deleteFile",data:{status:s,size:l,mimeType:r},eventVersion:1,notebook:n,currentUser:i}))},v=(e,t)=>{let{notebook:n,currentUser:i}=e,{fileToReplace:a,fileToAttach:s}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:replaceFile",data:{oldMimeType:a.mimeType,oldSize:a.size,oldStatus:a.status,newMimeType:s.type,newSize:s.size},eventVersion:1,notebook:n,currentUser:i}))},k=(e,t)=>{let{notebook:n,currentUser:i}=e,{file:{status:a,size:s,mimeType:l}}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:insertFile",data:{status:a,size:s,mimeType:l},eventVersion:1,notebook:n,currentUser:i}))},R=(e,t)=>{let{notebook:n,currentUser:i}=e,{file:{status:a,size:s,mimeType:l}}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:copyFileCode",data:{status:a,size:s,mimeType:l},eventVersion:1,notebook:n,currentUser:i}))},S=(e,t)=>{let{notebook:n,currentUser:i}=e,{file:{status:a,size:s,mimeType:l}}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:downloadFile",data:{status:a,size:s,mimeType:l},eventVersion:1,notebook:n,currentUser:i}))},w=(e,t)=>{let{notebook:n,currentUser:i}=e,{source:a,trigger:s,resolutions:l}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:dependenciesResolve",data:{source:a,trigger:s,count:l.length},eventVersion:1,notebook:n,currentUser:i}))},T=(e,t)=>{let{notebook:n,currentUser:i}=e,{locked:a,bulk:s}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:dependenciesToggleLock",data:{status:a?"locked":"unlocked",bulk:!!s},eventVersion:1,notebook:n,currentUser:i}))},M=e=>{let{notebook:t,currentUser:n}=e;(0,o.MR)((0,o.ym)({type:"notebook:manage:dependenciesUpgrade",eventVersion:1,notebook:t,currentUser:n}))},V=(e,t)=>{let{notebook:n,currentUser:i}=e,{status:a,updatesAvailable:s}=t;(0,o.MR)((0,o.ym)({type:"notebook:manage:dependenciesShowDetails",data:{status:a,updatesAvailable:s},eventVersion:1,notebook:n,currentUser:i}))}},21443:function(e,t,n){n.d(t,{Fe:function(){return c},J1:function(){return d},L3:function(){return u},cL:function(){return r}});var o=n(11163),i=n.n(o),a=n(33683),s=n(52332),l=n(7077);let r=()=>({isForking:!0}),u=()=>({isForking:!1}),d=async(e,t,n)=>{let{notebook:o,currentUser:a}=e;if(o.isForking)return;let s=await c(a,o,t,n);s?i().push("/[at]/[...specifiers]","/d/".concat(s.id)):n({type:"forkFailed"})};function c(e,t,n,o){let{trigger:i,source:r}=n;return new Promise(n=>{function u(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"session",n="local"===e?l.X:sessionStorage;n.setItem("forkId",t.id),n.setItem("fork",JSON.stringify({save_version:t.saveVersion,events:"model"in t?t.model.events.slice(t.saveVersion+1).map(e=>(0,a.e)(e)):[],publish_level:t.publishLevel}))}return e&&!(0,s.So)(e)?(u(),window.location.href="/team/new?next=%2Fforking",n(void 0)):e?void o({type:"showModal",modal:"fork",modalProps:{notebook:t,currentUser:e},trigger:"click",source:"notebookMenu"}):(o({type:"showModal",modal:"login",modalProps:{loginReason:"fork",message:"templateBanner"===r?"Sign up to use template":void 0,loginAction:u},trigger:i,source:r}),n(void 0))})}},29049:function(e,t,n){n.d(t,{CU:function(){return d},Kj:function(){return f},au:function(){return c},dY:function(){return y},gg:function(){return m},iQ:function(){return r},kO:function(){return p},qc:function(){return b},r2:function(){return g},rw:function(){return h}});var o=n(42831),i=n(94183),a=n(61802),s=n(91529),l=n(8273);let r=()=>({isPublishing:!0});function u(e,t){e({type:"showErrorToast",message:t,key:"publish"}),e({type:"publishFailed"})}let d=async(e,t,n)=>{let{notebook:o}=e,{unlisted:r,customSlug:d,customThumbnail:c,live:p}=t;if(o.isPublishing)return;let{id:g,slug:m,thumbnail:b}=o,h=(0,s.Ui)("model"in o?o.model:"title"in o?o:null);if(void 0!==d&&m!==d){n({type:"showProcessingToast",key:"publish",message:"Setting slug for ".concat(h,"…")});try{await (0,a.Fv)("/document/".concat(g,"/slug"),{slug:d||null})}catch(e){e.errors&&e.errors.length>0&&(null==e?void 0:e.errors[0].code)==="SLUG_INVALID"?u(n,"Setting notebook URL failed: URL invalid."):u(n,"Oops, setting notebook URL failed. Try again?");return}}let y=b;if(void 0!==c&&(c||b!==o.defaultThumbnail)&&c!==b){n({type:"showProcessingToast",key:"publish",message:"Setting thumbnail for ".concat(h,"…")});try{y=await (0,a.Fv)("/document/".concat(g,"/thumbnail"),{thumbnail:c||null})||o.defaultThumbnail}catch(e){u(n,"Oops, setting notebook thumbnail failed. Try again?");return}}let f={version:o.saveVersion,title:h,unlisted:r,live:p};try{n({type:"showProcessingToast",key:"publish",message:p?"Making ".concat(h," public…"):"Publishing ".concat(h,"…")});let{slug:e,update_time:t,access_level:s,files:u}=await (0,a.Fv)("/document/".concat(g,"/publish"),f);n({type:"showSuccessToast",message:p?"".concat(h," made public"):r?(0,l.cg)(o)?"Republished '".concat(h,"' (unlisted)"):"Published '".concat(h,"' (unlisted)"):(0,l.s9)(o)?"Republished '".concat(h,"'"):"Published '".concat(h,"'"),key:"publish"}),n({type:"publishSucceeded",publishVersion:o.saveVersion,updateTime:t,publishLevel:s,slug:e,thumbnail:y,files:(0,i.uu)(u)}),n({type:"updatedNotebook"})}catch(e){u(n,r?"Oops, unlisted publishing failed. Try again?":"Oops, publishing failed. Try again?")}},c=(e,t)=>{let{publishVersion:n,updateTime:i,slug:a,thumbnail:s,publishLevel:r,files:u}=t,{publishTime:d,roles:c}=e,p="live"===r&&"editorStates"in e&&(0,l.os)(e)?(0,o.qk)(e,!1):null,g="live"===r?c.filter(e=>"readonly"!==e):c;return{publishLevel:r,publishVersion:n,publishTime:d||i,editUnpublished:!1,thumbnail:s,slug:a,isPublishing:!1,roles:g,files:u,...p}},p=async(e,t,n)=>{let{notebook:o}=e,{unlisted:i}=t;if(o.isPublishing)return;let l=(0,s.Ui)("model"in o?o.model:"title"in o?o:null),r={version:o.saveVersion,live:!0,unlisted:i};try{let e=o.publishLevel;e!==(i?"live_unlisted":"live")&&(n({type:"showProcessingToast",key:"publish",message:"Making ".concat(l," public").concat(i?" (unlisted)":"","…")}),{access_level:e}=await (0,a.Fv)("/document/".concat(o.id,"/publish"),r),n({type:"showSuccessToast",message:"".concat(l," made public").concat(i?" (unlisted)":""),key:"publish"})),n({type:"publishLiveSucceeded",publishLevel:e}),n({type:"updatedNotebook"})}catch(e){u(n,"Oops, making public failed. Try again?")}},g=(e,t)=>{let{publishLevel:n}=t,{roles:i}=e,a="live"===n&&"editorStates"in e&&(0,l.os)(e)?(0,o.qk)(e,!1):null,s="live"===n?i.filter(e=>"readonly"!==e):i;return{publishLevel:n,editUnpublished:!1,isPublishing:!1,roles:s,...a}},m=()=>({isPublishing:!1}),b=()=>({isUnpublishing:!0}),h=async(e,t,n)=>{let{notebook:o}=e;if(o.isUnpublishing)return;let l=(0,s.Ui)("model"in o?o.model:"title"in o?o:null),r="live"===o.publishLevel||"live_unlisted"===o.publishLevel;try{n({type:"showProcessingToast",key:"unpublish",message:r?"Removing public access to ".concat(l,"…"):"Unpublishing ".concat(l,"…")});let e=await (0,a.Fv)("/document/".concat(o.id,"/unpublish"),void 0);n({type:"showSuccessToast",message:r?"Removed public access to ".concat(l):"Unpublished '".concat(l,"'"),key:"unpublish"}),n({type:"unpublishSucceeded",slug:e.slug||null,files:(0,i.uu)(e.files)})}catch(e){n({type:"showErrorToast",message:r?"Oops, removing public access failed. Try again?":"Oops, unpublishing failed. Try again?",key:"unpublish"}),n({type:"unpublishFailed"})}},y=(e,t)=>{let{slug:n,files:o}=t;return{publishLevel:"private",publishVersion:null,publishTime:null,editUnpublished:!1,slug:n,isUnpublishing:!1,pausedVersion:null,files:o}},f=()=>({isUnpublishing:!1})},36515:function(e,t,n){n.d(t,{B:function(){return l},b:function(){return r}});var o=n(61802),i=n(46294),a=n(75406);function s(e){let t=new Set(e.map(e=>e.login));return e=>!t.has(e.login)}let l=async(e,t,n)=>{var l,r;let{notebook:u,currentUser:d}=e,{currentMembers:c,newMembers:p,newRoles:g,message:m}=t,{id:b}=u,h=e=>"invited"===e.status,y=e=>"member"===e.status,f=function(e){let t=new Map(e.map(e=>[e.login,e]));return e=>t.has(e.login)&&t.get(e.login).role!==e.role}(c),v=s(p),k=s(c),R=p.filter(y).filter(k),S=p.filter(y).filter(f),w=c.filter(y).filter(v),T=p.filter(h).filter(k).map(e=>({email:e.login,role:e.role})),M=c.filter(h).filter(v).map(e=>({email:e.login})),V=p.some(e=>"team"===e.type)?"team":p.length>1||p.some(e=>"group"===e.type)?"shared":"private";try{await (0,o.Fv)("/document/".concat(b,"/roles"),{roles:[...R,...S].map(e=>{let{id:t,role:n}=e;return{user_id:t,role:n}}).concat(w.map(e=>{let{id:t}=e;return{user_id:t,role:null}})),invitations:T.map(e=>({email:e.email,role:e.role})).concat(M.map(e=>({email:e.email,role:null}))),message:m})}catch(e){(0,a.S)({key:"setRoles",error:e,dispatch:n,message:"Unable to set roles"});return}for(let{id:e,role:t,team_role:n,type:o}of R)(0,i.MR)((0,i.ym)({type:"notebook:manage:changeRole",notebook:u,currentUser:d,data:{prevRole:(null===(l=c.find(t=>t.id===e))||void 0===l?void 0:l.role)||null,newRole:t,userId:e,userType:o,memberId:n?e:void 0,memberRole:null!=n?n:void 0},eventVersion:5})),gtag("event","Change role",{event_category:"Notebook"});for(let{id:e,team_role:t,type:n}of w)(0,i.MR)((0,i.ym)({type:"notebook:manage:changeRole",notebook:u,currentUser:d,data:{prevRole:(null===(r=w.find(t=>t.id===e))||void 0===r?void 0:r.role)||null,newRole:null,userId:e,userType:n,memberId:t?e:void 0,memberRole:null!=t?t:void 0},eventVersion:5})),gtag("event","Change role",{event_category:"Notebook"});n({type:"shareSucceeded",newSharing:V,newRoles:g}),n({type:"updatedNotebook"})},r=(e,t)=>{let{newSharing:n,newRoles:o}=t;if(0===o.length){location.replace("/");return}return{sharing:n,roles:o}}},56177:function(e,t,n){n.d(t,{g:function(){return a},m:function(){return i}});var o=n(61802);let i=async(e,t,n)=>{let i,{slug:a}=t,{notebook:{id:s}}=e;try{i=await (0,o.Fv)("/document/".concat(s,"/slug"),{slug:a})}catch(e){n(e.errors&&e.errors.length>0&&"SLUG_INVALID"===e.errors[0].code?{type:"showErrorToast",message:"Setting notebook URL failed: URL invalid.",key:"setSlug"}:{type:"showErrorToast",message:"Oops, setting notebook URL failed. Try again?",key:"setSlug"});return}n({type:"setSlugSucceeded",slug:i.slug}),n({type:"updatedNotebook"})},a=(e,t)=>{let{slug:n}=t;return{slug:n}}},49348:function(e,t,n){n.d(t,{QJ:function(){return u},fv:function(){return l},pT:function(){return r},zu:function(){return d}});var o=n(85893),i=n(96612),a=n(61802),s=n(68098);let l=async(e,t,n)=>{let{notebook:{id:s}}=e,{trashed:l,relocate:r=!0,showToast:u=!r}=t;try{await (0,a.Fv)("/document/".concat(s,"/trash"),{trashed:l}),n({type:"trashSucceeded",trashed:l,relocate:r}),u&&(n({type:"showSuccessToast",message:l?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"flex items-center",children:[i.MI,"Moved to trash"]}),(0,o.jsx)("button",{onClick:()=>{n({type:"trashRequested",trashed:!1,relocate:r})},className:"pa0 fw6 no-underline gray hover-dark-gray bg-transparent bn pointer",children:"Undo"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{className:"flex items-center",children:[i.MI,"Moved out of trash"]}),(0,o.jsx)("button",{onClick:()=>{n({type:"trashRequested",trashed:!0,relocate:r})},className:"pa0 fw6 no-underline gray hover-dark-gray bg-transparent bn pointer",children:"Undo"})]}),key:"trash"}),n({type:"updatedNotebook"}))}catch(e){n({type:"trashFailed"}),n({type:"showErrorToast",message:l?"Oops, trashing failed. Try again?":"Oops, moving out of trash failed. Try again?",key:"trash"})}},r=()=>({isUpdatingTrash:!0}),u=(e,t)=>{let{owner:n}=e,{trashed:o,relocate:i}=t;if(o&&i){location.assign((0,s.i7)(n));return}return{trashed:o,isUpdatingTrash:!1}},d=()=>({isUpdatingTrash:!1})},89934:function(e,t,n){n.d(t,{k:function(){return i}});var o=n(46294);let i=(e,t)=>{let{currentUser:n,notebook:i}=e;"setSlug"===t.modal&&(0,o.MR)((0,o.ym)({type:"notebook:view:slugModal",data:{isSlugSet:!!i.slug},eventVersion:1,notebook:i,currentUser:n}))}},5409:function(e,t,n){n.d(t,{$:function(){return a},W:function(){return s}});var o=n(61802),i=n(91529);let a=async(e,t,n)=>{let{notebook:a}=e,{customThumbnail:s}=t,{id:l,thumbnail:r}=a,u=(0,i.Ui)("model"in a?a.model:"title"in a?a:null);if((s||r!==a.defaultThumbnail)&&s!==r){n({type:"showProcessingToast",key:"thumbnail",message:"Setting thumbnail for ".concat(u,"…")});try{let e=await (0,o.Fv)("/document/".concat(l,"/thumbnail"),{thumbnail:s||null});n({type:"showSuccessToast",key:"thumbnail",message:"Updated thumbnail"}),n({type:"setNotebookThumbnailSucceeded",customThumbnail:e}),n({type:"updatedNotebook"})}catch(e){n({type:"showErrorToast",message:"Oops, setting notebook thumbnail failed. Try again?",key:"thumbnail"});return}}},s=(e,t)=>{let{defaultThumbnail:n}=e,{customThumbnail:o}=t;return{customThumbnail:o,thumbnail:o||n}}},68326:function(e,t,n){n.d(t,{l:function(){return g}});var o=n(89934),i=n(5409),a=n(92884),s=n(18824),l=n(76975),r=n(29049),u=n(36515),d=n(56177),c=n(90714),p=n(49348);let g={collections:s.N5,descriptionUpdate:l.y,publishLiveRequested:r.kO,publishRequested:r.CU,publishSucceeded:a.dE,publishLiveSucceeded:a.dE,showModal:o.k,setNotebookThumbnail:i.$,setSlug:d.m,setSlugSucceeded:a.pf,share:u.B,transfer:c.r,trashRequested:p.fv,trashSucceeded:a.d$,unpublishRequested:r.rw,unpublishSucceeded:a.CL}},33631:function(e,t,n){n.d(t,{x:function(){return d}});var o=n(5409),i=n(21443),a=n(29049),s=n(36515),l=n(56177),r=n(90714),u=n(49348);let d={forkFailed:i.L3,forkPending:i.cL,publishRequested:a.iQ,publishSucceeded:a.au,publishFailed:a.gg,publishLiveSucceeded:a.r2,setNotebookThumbnailSucceeded:o.W,setSlugSucceeded:l.g,shareSucceeded:s.b,trashFailed:u.zu,trashRequested:u.pT,transferSucceeded:r.I,trashSucceeded:u.QJ,unpublishRequested:a.qc,unpublishSucceeded:a.dY,unpublishFailed:a.Kj}}}]);